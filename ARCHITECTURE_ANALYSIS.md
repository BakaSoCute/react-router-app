# –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

## üî¥ –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è **–∏** –≤ RTK Query –∫—ç—à–µ (`api` reducer), **–∏** –≤ Redux slice (`account` reducer)
- –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏ —É—Å–ª–æ–∂–Ω—è–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É

### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
- –í `accountSlice.ts` –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —Ö—É–∫ `useGetUserQuery` (—Å—Ç—Ä–æ–∫–∞ 3) - **—Ö—É–∫–∏ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ slice**
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π `data` –∏–∑ react-router

### 3. –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–¥
- –ü—É—Å—Ç–æ–π reducer `getUser` –≤ `accountSlice.ts`
- –í `root.tsx` –¥–µ–ª–∞—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è

### 4. –ù–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –æ—Ç–∫—É–¥–∞ –±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ: –∏–∑ RTK Query –∏–ª–∏ –∏–∑ Redux?
- –í `_auth.main-page/route.tsx` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Redux, –Ω–æ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 1: RTK Query –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
- **RTK Query** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Redux slice —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Ñ–ª–∞–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ —É–±—Ä–∞—Ç—å —Å–æ–≤—Å–µ–º)
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ö—É–∫–∏ RTK Query –Ω–∞–ø—Ä—è–º—É—é

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫—ç—à –∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- ‚úÖ –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```typescript
// accountSlice.ts - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
interface AccountState {
  isLogin: boolean  // –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å validUser –∏–∑ API
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:
const { data: user, isLoading } = useGetUserQuery();
const { data: isValid } = useValidUserQuery();
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—É–∫–∏ RTK Query –≤ –∫–∞–∂–¥–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: Redux –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
- Redux slice —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- RTK Query –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Redux
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–µ–ª–µ–∫—Ç–æ—Ä—ã Redux

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ª—é–±–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã
- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ–∑ —Ö—É–∫–æ–≤ RTK Query

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```typescript
// accountSlice.ts
extraReducers: (builder) => {
  builder
    .addMatcher(api.endpoints.getUser.matchFulfilled, (state, action) => {
      state.user = action.payload.user;
      state.isLogin = true;
    })
    .addMatcher(api.endpoints.validUser.matchFulfilled, (state, action) => {
      state.isLogin = action.payload.isValid;
    })
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
const user = useAppSelector(selectUser);
const isLogin = useAppSelector(selectLogin);
```

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- –ù—É–∂–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints —Å Redux
- –ë–æ–ª—å—à–µ –∫–æ–¥–∞ –≤ extraReducers

---

## ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 3: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–∫–æ–º–ø—Ä–æ–º–∏—Å—Å)

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è
- RTK Query –¥–ª—è **—Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö** (–∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞)
- Redux –¥–ª—è **–ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è** (—Ñ–ª–∞–≥–∏, UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏-–æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- ‚úÖ –ì–∏–±–∫–æ—Å—Ç—å: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞
- ‚úÖ RTK Query –¥–ª—è –¥–∞–Ω–Ω—ã—Ö, Redux –¥–ª—è UI —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```typescript
// hooks/useAuth.ts - –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ö—É–∫
export const useAuth = () => {
  const { data: user, isLoading } = useGetUserQuery(undefined, {
    skip: !useAppSelector(selectLogin)
  });
  const isLogin = useAppSelector(selectLogin);
  
  return { user, isLogin, isLoading };
};
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –í–∞—Ä–∏–∞–Ω—Ç 1 (RTK Query)

### –ü–æ—á–µ–º—É?
1. –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –∏ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
2. RTK Query —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫—ç—à –∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è
4. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥

### –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

1. **–£–ø—Ä–æ—Å—Ç–∏—Ç—å accountSlice** - —É–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **–°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å root.tsx** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤
4. **–°–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ä–æ—É—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ RTK Query

---

## üìù –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å `accountSlice.ts` - —É–±—Ä–∞—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
2. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
4. ‚úÖ –°–æ–∑–¥–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ä–æ—É—Ç `_auth.tsx`
5. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å `root.tsx` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
