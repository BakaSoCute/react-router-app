# Исправление проблемы с автоматической повторной авторизацией после logout

## Проблема
При выходе из аккаунта происходил редирект на главную страницу, где снова вызывался `useAuth()`. Так как токены оставались в куках, данные пользователя автоматически загружались снова.

## Решение

### 1. Добавлен endpoint logout в API
```typescript
logout: builder.mutation<LogoutResponse, void>({
    query: () => ({
        url: "/api/auth/logout",
        method: "POST",
    }),
    invalidatesTags: ["User", "Valid", "Auth"]
})
```

### 2. Добавлен флаг `wasLoggedOut` в Redux
- Устанавливается в `true` при logout
- Сбрасывается в `false` только при успешной авторизации
- Используется для блокировки запросов после logout

### 3. Обновлен `useAuth()` хук
- Проверяет флаг `wasLoggedOut` перед выполнением запросов
- Если `wasLoggedOut === true`, запросы не выполняются (`skip: true`)

### 4. Обновлен logout route
- Вызывает API endpoint `/api/auth/logout` для очистки сессии на бэкенде
- Устанавливает флаг `isLoggingOut` для блокировки запросов во время процесса logout
- Очищает состояние Redux и кэш RTK Query
- Устанавливает флаг `wasLoggedOut = true` через `dispatch(logout())`

## Как это работает

1. **При logout:**
   - Устанавливается `isLoggingOut = true` → блокирует запросы
   - Вызывается API `/api/auth/logout` (если поддерживается бэкендом)
   - Вызывается `dispatch(logout())` → устанавливает `wasLoggedOut = true`
   - Очищается кэш RTK Query
   - Происходит редирект на главную

2. **После редиректа:**
   - `useAuth()` проверяет `wasLoggedOut === true`
   - Запросы не выполняются (`skip: true`)
   - Пользователь остается разлогиненным

3. **При следующей авторизации:**
   - При успешном `getUser` флаг `wasLoggedOut` сбрасывается в `false`
   - Запросы снова работают нормально

## Важные моменты

- Если бэкенд не поддерживает `/api/auth/logout`, куки могут остаться, но фронтенд не будет делать запросы благодаря флагу `wasLoggedOut`
- Флаг `wasLoggedOut` сбрасывается только при успешной авторизации, что предотвращает автоматическую повторную загрузку данных
- Используется комбинация `isLoggingOut` (временный флаг) и `wasLoggedOut` (постоянный флаг) для надежной блокировки запросов
